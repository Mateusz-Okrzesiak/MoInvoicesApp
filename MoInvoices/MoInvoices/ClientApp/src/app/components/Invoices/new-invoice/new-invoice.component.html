
<mat-toolbar class="full-width">
    <mat-toolbar-row ><div class="offset-lg-2"><h1 id="tableLabel"><strong>Faktura VAT</strong> </h1></div></mat-toolbar-row>
</mat-toolbar>

  <section class="newInvoiceSection">
    <div class="container col-md-8 col-sm-12">    
        <div class="row">
            <div class="col-md-4 col-sm">
                <mat-form-field class="full-width"> 
                    <mat-label>Typ dokumentu</mat-label>
                    <mat-select required [(ngModel)]="invoice.documentType">
                    <mat-option value="Faktura VAT">Faktura VAT</mat-option>                    
                    <mat-option value="Faktura proforma">Faktura proforma</mat-option>
                 </mat-select>
               </mat-form-field>
            </div>
            <div class="col-md-4 col-sm">         
                <mat-form-field class="full-width">
                    <mat-label>Numer</mat-label>
                    <input matInput required placeholder="Numer dokumentu" value="01/05/2020" [(ngModel)]="invoice.invoiceNumber">
                </mat-form-field>
            </div>
            <div class="col-md-4 col-sm">      
                <mat-form-field class="full-width">
                    <mat-label>Data wystawienia</mat-label>
                    <input matInput required [matDatepicker]="picker" [(ngModel)]="invoice.issueDate">
                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-datepicker #picker></mat-datepicker>
                </mat-form-field>
            </div>
        </div>    
        <div class="row">
            <div class="col-md-4 col-sm">    
                <mat-form-field class="full-width">
                <mat-label>Miejsce wystawienia</mat-label>
                <input matInput required placeholder="Miejscowość" [(ngModel)]="invoice.cityOfIssue">
                </mat-form-field>
            </div>
            <div class="col-md-4 col-sm">
                <mat-form-field>
                    <mat-label>Data sprzedaży</mat-label>
                    <input required matInput [matDatepicker]="FinishServiceDate" [(ngModel)]="invoice.sellData">
                    <mat-datepicker-toggle matSuffix [for]="FinishServiceDate"></mat-datepicker-toggle>
                    <mat-datepicker #FinishServiceDate></mat-datepicker>
                </mat-form-field>
            </div>    
        </div>
        <div class="form-inline">
            <div class="col-md-6 offset-top-15">
                <div class="col-md-9 col-md-offset-3">
                    <button mat-icon-button>
                        <mat-icon color="primary">folder_open</mat-icon>
                    </button>
                    <button mat-icon-button>
                        <mat-icon color="primary">cloud_download</mat-icon>
                    </button>
                </div>
                <div class="row">
                    <mat-label class="col-lg-3 col-sm-4 line-height">Sprzedawca</mat-label>
                    <mat-form-field class="col-md-9 col-sm">              
                        <textarea required cdkAutosizeMinRows="1" cdkTextareaAutosize matInput [(ngModel)]="invoice.vendor.name" ></textarea>
                    </mat-form-field>
                </div>
                <div class="row">
                    <mat-label class="col-md-3 col-sm line-height">NIP</mat-label>
                    <mat-form-field class="col-md-9 col-sm">              
                        <input matInput required [(ngModel)]="invoice.vendor.nip">
                    </mat-form-field>
                </div>
                <div class="row">
                    <mat-label class="col-md-3 col-sm line-height">Ulica</mat-label>
                    <mat-form-field class="col-md-9 col-sm">              
                        <input matInput required [(ngModel)]="invoice.vendor.street">
                    </mat-form-field>
                </div>
                <div class="row">
                    <mat-label class="col-md-3 col-sm line-height">Miasto / kod</mat-label>
                    <mat-form-field class="col-md-6 col-sm">
                        <input matInput required [(ngModel)]="invoice.vendor.city">
                    </mat-form-field>
                    <mat-form-field class="col-md-3 col-sm">
                        <input matInput required [(ngModel)]="invoice.vendor.postalCode">
                    </mat-form-field>
                </div>
            </div>
            <div class="col-md-6 offset-top-15">
                <div class="col-md-9 col-md-offset-3">
                    <button mat-icon-button>
                        <mat-icon color="primary">folder_open</mat-icon>
                    </button>
                    <button mat-icon-button>
                        <mat-icon color="primary">cloud_download</mat-icon>
                    </button>
                </div>
                <div class="row">
                    <mat-label class="col-lg-3 col-sm-4 line-height">Nabywca</mat-label>
                    <mat-form-field class="col-md-9 col-sm">              
                        <textarea required cdkAutosizeMinRows="1" cdkTextareaAutosize matInput [(ngModel)]="invoice.purchaser.name"></textarea>
                    </mat-form-field>
                </div>
                <div class="row">
                    <mat-label class="col-md-3 col-sm line-height">NIP</mat-label>
                    <mat-form-field class="col-md-9 col-sm">              
                        <input matInput required [(ngModel)]="invoice.purchaser.nip">
                    </mat-form-field>
                </div>
                <div class="row">
                    <mat-label class="col-md-3 col-sm line-height">Ulica</mat-label>
                    <mat-form-field  class="col-md-9 col-sm">              
                        <input matInput required [(ngModel)]="invoice.purchaser.street">
                    </mat-form-field>
                </div>
                <div class="row">
                    <mat-label class="col-md-3 col-sm line-height">Miasto / kod</mat-label>
                    <mat-form-field class="col-md-6 col-sm">
                        <input matInput required [(ngModel)]="invoice.purchaser.city" >
                    </mat-form-field>
                    <mat-form-field class="col-md-3 col-sm">
                        <input matInput required [(ngModel)]="invoice.purchaser.postalCode">
                    </mat-form-field>
                </div>
            </div>
        </div>
    </div>
    <div class="container col-md-8 col-sm-12">   
        <div class="row">
            <table mat-table [dataSource]="invoice.service" class="col-8">
               
                <ng-container matColumnDef="serviceName">
                    <th mat-header-cell *matHeaderCellDef> Nazwa towaru lub usługi </th>
                    <td mat-cell *matCellDef="let element">               
                        <mat-form-field >
                            <input matInput required type="text" (change)="updateServiceName(element, $event.target.value)">              
                        </mat-form-field>
                    </td>
                </ng-container>
            
                <ng-container matColumnDef="JM">
                    <th id="JM" mat-header-cell  *matHeaderCellDef> Jm. </th>
                    <td mat-cell *matCellDef="let element"> 
                        <input matInput required type="text" value={{element.JM}}>     
                    </td>
                </ng-container>
            
                <ng-container matColumnDef="quantity">
                    <th mat-header-cell *matHeaderCellDef> Ilość </th>
                    <td mat-cell *matCellDef="let element"> 
                        <input matInput required type="text" value={{element.quantity}} (change)="updateQuantity(element, $event.target.value)">    
                    </td>
                </ng-container>
            
                <ng-container matColumnDef="netPrice">
                    <th mat-header-cell *matHeaderCellDef> Cena Netto </th>
                    <td mat-cell *matCellDef="let element">
                        <mat-form-field >
                            <input matInput required type='number' value={{element.netPrice.toFixed(2)}} (change)="updateNetPrice(element, $event.target.value)">              
                        </mat-form-field>
                    </td>
                </ng-container>

                <ng-container matColumnDef="netWorth">
                    <th mat-header-cell *matHeaderCellDef> Wartość netto </th>
                    <td mat-cell *matCellDef="let element">
                        <mat-form-field>
                            <input matInput type="text" readonly value={{element.netWorth.toFixed(2)}}>
                        </mat-form-field>
                    </td>
                </ng-container>

                <ng-container matColumnDef="vatRate">
                    <th mat-header-cell *matHeaderCellDef> Stawka VAT </th>
                    <td mat-cell *matCellDef="let element">
                        <mat-form-field>
                            <input matInput required type="text" readonly value={{element.vatRate}}>
                        </mat-form-field>
                    </td>
                </ng-container>

                <ng-container matColumnDef="vatAmount">
                    <th mat-header-cell *matHeaderCellDef> Kwota VAT</th>
                    <td mat-cell *matCellDef="let element">
                        <mat-form-field>
                            <input matInput type="text" readonly value={{element.vatAmount.toFixed(2)}}>
                        </mat-form-field>
                    </td>
                </ng-container>

                <ng-container matColumnDef="grossValue">
                    <th mat-header-cell *matHeaderCellDef> Wartość Brutto</th>
                    <td mat-cell *matCellDef="let element">
                        <mat-form-field>
                            <input matInput type="text" readonly value={{element.grossValue.toFixed(2)}}>
                        </mat-form-field>
                    </td>
                </ng-container>
            
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
            <button mat-raised-button color="primary" (click)="addNewServicePosition()">
                <mat-icon>create</mat-icon>
            </button>
        </div>    

        <section>
            <div class="row summary">
                <mat-label class="col-md-2 col-sm line-height">Razem brutto</mat-label>
                <mat-form-field class="col-md-2 col-sm">              
                    <input matInput readonly type="number" [(ngModel)]="invoice.sumGrossValue">
                </mat-form-field>    
            </div>  
            <div class="row summary">
                <mat-label class="col-md-2 col-sm line-height">Razem netto</mat-label>
                <mat-form-field class="col-md-2 col-sm">              
                    <input matInput readonly type="number" [(ngModel)]="invoice.sumNetValue" >
                </mat-form-field>    
            </div>  
        </section>  
        <div class="row">
            <div class="col-md-2">        
                <button mat-raised-button color="warn" (click)=createInvoice() >Zapisz</button>  <!-- [disabled]="!invoiceForm.form.valid"] -->
            </div>     
            <div class="col-md-2">   
                <button mat-raised-button color="warn">Pobierz</button>
            </div>
        </div>
    </div>
</section>
